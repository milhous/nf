{"version":3,"sources":["main.js"],"names":["SceneType","cc","Enum","INDEX","FORM","JOIN","CHOOSE","PUZZLE","SUCCEED","Scene","Class","name","properties","type","default","node","Node","extends","Component","ctor","_sceneIndex","scenes","btnPass","btnSubmit","btnJoin","btnAgain","btnGet","puzzle","video","VideoPlayer","onLoad","manager","director","getCollisionManager","enabled","getComponent","on","EventType","TOUCH_END","handleSubmit","handleJoin","handleAgain","handleGet","handlePass","handleReady","handleClick","evt","log","detail","nextScene","updateBlock","index","start","update","dt","play","document","addEventListener","destroy","prevScene","location","href","map","obj","active"],"mappings":"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","file":"main.js","sourceRoot":"../../../../assets/script","sourcesContent":["// 场景\nconst SceneType = cc.Enum({\n    INDEX: 0,\n    FORM: 1,\n    JOIN: 2,\n    CHOOSE: 3,\n    PUZZLE: 4,\n    SUCCEED: 5\n});\n\nconst Scene = cc.Class({\n    name: 'Scene',\n    properties: {\n        type: {\n            default: SceneType.INDEX,\n            type: SceneType\n        },\n        node: cc.Node\n    }\n});\n\ncc.Class({\n    extends: cc.Component,\n\n    ctor() {\n        // 场景索引值\n        this._sceneIndex = 0;\n    },\n\n    properties: {\n        scenes: {\n            default: [],\n            type: Scene\n        },\n        btnPass: {\n            default: null,\n            type: cc.Node\n        },\n        btnSubmit: {\n            default: null,\n            type: cc.Node\n        },\n        btnJoin: {\n            default: null,\n            type: cc.Node\n        },\n        btnAgain: {\n            default: null,\n            type: cc.Node\n        },\n        btnGet: {\n            default: null,\n            type: cc.Node\n        },\n        puzzle: {\n            default: null,\n            type: cc.Node\n        },\n        video: {\n            default: null,\n            type: cc.VideoPlayer\n        }\n    },\n\n    onLoad() {\n        // 开启碰撞\n        const manager = cc.director.getCollisionManager();\n        manager.enabled = true;\n\n        // 初始化组件\n        this.puzzle = this.puzzle.getComponent('puzzle');\n\n        // 定义事件\n        this.btnSubmit.on(cc.Node.EventType.TOUCH_END, this.handleSubmit, this);\n\n        this.btnJoin.on(cc.Node.EventType.TOUCH_END, this.handleJoin, this);\n\n        this.btnAgain.on(cc.Node.EventType.TOUCH_END, this.handleAgain, this);\n\n        this.btnGet.on(cc.Node.EventType.TOUCH_END, this.handleGet, this);\n\n        this.btnPass.on(cc.Node.EventType.TOUCH_END, this.handlePass, this);\n\n        this.video.node.on('ready-to-play', this.handleReady, this);\n        this.video.node.on('clicked', this.handleClick, this);\n\n        this.node.on('nextScene', (evt) => {\n            cc.log(evt.detail);\n\n            this.nextScene();\n        });\n\n        this.node.on('choosePuzzle', (evt) => {\n            cc.log(evt.detail);\n\n            this.puzzle.updateBlock(evt.detail.index);\n\n            this.nextScene();\n        });\n    },\n\n    start() {},\n\n    update(dt) {},\n\n    // 准备视频\n    handleReady(evt) {\n        const video = evt;\n        video.play();\n\n        document.addEventListener(\"WeixinJSBridgeReady\", function() {\n            video.play();\n        });\n\n        cc.log('evt', evt);\n    },\n\n    // 用户点击\n    handleClick(evt) {\n        const video = evt;\n\n        video.play();\n    },\n\n    // 跳过视频\n    handlePass(evt) {\n        this.video.destroy();\n\n        this.nextScene();\n    },\n\n    // 提交表单\n    handleSubmit() {\n        this.nextScene();\n    },\n\n    // 加入互动\n    handleJoin() {\n        cc.log('加入互动');\n\n        this.nextScene();\n    },\n\n    // 再次挑战\n    handleAgain() {\n        cc.log('再次挑战');\n\n        this.prevScene();\n    },\n\n    // 获取权益\n    handleGet() {\n        location.href = 'https://weapp.wemediacn.com/tnf/north/vipeak/to_auth_page?page_type=user_center';\n    },\n\n    // 跳转下一个场景\n    nextScene() {\n        this._sceneIndex++;\n\n        this.scenes.map((obj) => {\n            obj.node.active = obj.type === this._sceneIndex;\n        });\n    },\n\n    // 跳转上一个场景\n    prevScene() {\n        this._sceneIndex--;\n\n        if (this._sceneIndex < 0) {\n            this._sceneIndex = 0;\n        }\n\n        this.scenes.map((obj) => {\n            obj.node.active = obj.type === this._sceneIndex;\n        });\n    }\n});"]}